\chapter{実験の設定}\label{sec:simulation}

この章では, 行ったシミュレーションの設定についてそれぞれ説明をしていく.

系の上下両端のポテンシャルエネルギー差$mgL_y$と運動エネルギー差$k_{\text{B}}\Delta T$の比を$\chi$として以下のように設定する.

\begin{align}
  \chi &\equiv \frac{k_{\text{B}}\Delta T}{mgL_{y}} = 1.265
\end{align}

壁の濡れ性を制御する無次元パラメータを2つ用意する.

\begin{align}
  \text{R}_\text{t} &: 壁の厚み. \\
  \text{R}_\text{a} &: 引力幅.
\end{align}

これらを用いて, 壁-粒子間相互作用のLJポテンシャルを以下のように書き表す.

\begin{align}
  \sigma^{\text{wall}} &= \qty(0.5 + \text{R}_\text{t}) \times \sigma , \\
  r^{\text{wall}}_{\text{cut}} &= \qty(2^{1/6} + \text{R}_\text{a}) \times \sigma^{\text{wall}} 
\end{align}

パラメータ $(\text{R}_\text{t}, \text{R}_\text{a})$ を変えることによって, 壁-粒子間相互作用LJポテンシャルが変わる. このときに, 粒子集団の様相がどのように変化するかをみることが本論の主題である.

$\text{R}_\text{t}$ と $\text{R}_\text{a}$ を少しずつ変えた系でシミュレーションをして, 粒子集団の様相の変化を見たい. 以下に示すのが, それらを動かす範囲である.

\begin{align}
  \text{R}_\text{t} &\colon 0.0 \sim 0.5 \\
  \text{R}_\text{a} &\colon 0.0 \sim 3.0 - 2^{1/6} = 1.877538\dots
\end{align}

数値実験上で実際に入力する値を以下に示す. 本論では簡単のため小数点以下をいくらか簡略して示すことがある.

\begin{align}
  \text{R}_\text{t} &= 0.0,  0.125,  0.25,  0.375,  0.5 \\
  \text{R}_\text{a} &= 0.0,  0.4693845,  0.938769,  1.4081535,  1.877538
\end{align}

以下は$\text{R}_\text{t}$, $\text{R}_\text{a}$を変化させたときのLJポテンシャルがどのように変化するのかをそれぞれ可視化したグラフである.

参考のために, 各パラメータの値を変えることによって, カットオフ長と衝突直径がどのように変わるのかを示す.

\begin{align}
  \text{R}_\text{a} &= 0.0 \Rightarrow r_{\text{cut}}^{\text{wall}} = 2^{1/6} \sigma^{\text{wall}} \\
  \text{R}_\text{a} &= 1.877 \Rightarrow r_{\text{cut}}^{\text{wall}} = 3.0 \sigma^{\text{wall}} 
\end{align}

\begin{align}
  \text{R}_\text{t} &= 0.0 \Rightarrow \sigma^{\text{wall}} = 0.5 \sigma \\
  \text{R}_\text{t} &= 0.5 \Rightarrow \sigma^{\text{wall}} = \sigma 
\end{align}

である. 

\input{subtex/RaRtmap_LJ.tex}

本章の以降の実験は特記がない限り以下のパラメータで行うものとする. 

\begin{itemize}
  \item $N = 1250$: 粒子数
  \item $\rho {\sigma}^2 = 0.4$: 粒子数密度
  \item $L_x / \sigma = 39.528471 \simeq 39.5$: 系の$x$幅
  \item $L_y / \sigma = 79.0569414 \simeq 79.0$: 系の$y$幅
  \item $k_{\text{B}} T / \varepsilon = 0.43$: 初期温度
  \item $k_{\text{B}} \Delta T / \varepsilon = 0.04$: 熱浴の温度差
  \item $mg\sigma/\varepsilon = 0.0003999718779659611 \simeq 4.0 \times 10^{-4}$: 粒子にかかる重力の大きさ
  \item $\dd t \sqrt{\varepsilon/m{\sigma}^2} = 0.005$: シミュレーションにおける時間刻み.
\end{itemize}


以下に記すのは, 今後解析をする際に示すシミュレーションについての時間に関する説明である.

\begin{itemize}
  \item $t_i \colon$ シミュレーション開始時から, 物理量を解析する際にデータを採用し始める時間. これ以降は定常状態であるとみなす.
  \item $t_f \colon$ シミュレーション開始時から, シミュレーションの終了時までの時間.
\end{itemize}

図\ref{fig:RaRtmap_time}, \ref{fig:RaRtmap_drop_time}, \ref{fig:dT0_time}, \ref{fig:g0_time}, \ref{fig:RaRtmap10_time}, \ref{fig:qrs10_drop_time}では重心位置の時間発展を示しているのだが, 分析と考察で用いる$t_i$の時点がわかるように赤直線を引くことにしている.

いずれの実験の場合も$t\sqrt{\varepsilon/m{\sigma}^2}=0$の時点では粒子は以下の画像のように, 系に規則正しく並べられているとする.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.2]{image/initial1250.png}
  \caption{$N=1250, t\sqrt{\varepsilon/m{\sigma}^2}=0$}
  \label{}
\end{figure}

% \section{先行研究}

% 壁を完全に濡らしている状態を考えたいので, $r^{\text{wall}}_{\text{cut}}=3.0\sigma$ に設定する.

% また, 重力をかけた状態で粒子が下に落ちきり, 定常状態にあるとみなせるまでシミュレーションを行ってから, 熱流をかけている.\cite{Yoshida}

% \begin{itemize}
%   \item $N = 5000$
%   \item $\rho \sigma^2 = 0.4$
%   \item $L_x / \sigma \simeq 79.0$
%   \item $L_y / \sigma \simeq 158.1$
%   \item $k_{\text{B}} T/\varepsilon = 4.3$
%   \item $k_{\text{B}} \Delta T/\varepsilon = 0.0$
%   \item $mg\sigma/\varepsilon \simeq 2.0 \times 10^{-4}$
%   \item ${t_f}^{\prime} \sqrt{\varepsilon / m \sigma^2} = 5.0 \times 10^{5}$
% \end{itemize}

% \begin{figure}[H]
%   \centering
%   \includegraphics[scale=0.2]{image/drop5000.png}
%   \caption{$t \sqrt{\varepsilon / m \sigma^2} = 5.0 \times 10^{5}$でのスナップショット}
%   \label{}
% \end{figure}

% 続いて重力をかけた緩和後の系で, 温度差のある熱浴をそれぞれ改めて以下のようにつけ, 熱流をかけてシミュレーションをしている. 

% \begin{itemize}
%   \item $\chi = k_{\text{B}}\Delta T / mg L_y = 1.265$
%   \item $k_{\text{B}} \Delta T/\varepsilon = 0.04$
%   \item $t_i \sqrt{\varepsilon / m \sigma^2} = 5.0 \times 10^{5}$
%   \item $t_f \sqrt{\varepsilon / m \sigma^2} = 1.0 \times 10^{6}$
% \end{itemize}

% $(\text{R}_\text{t} = 0.5, \text{R}_\text{a} = 3.0 - 2^{1/6})$ で実験を行う. このときには, $(\varepsilon^{\text{wall}} = \varepsilon, \sigma^{\text{wall}} = \sigma, r^{\text{wall}}_{\text{cut}} = 3.0 \sigma^{\text{wall}})$ になるので, ${\phi_{\text{LJ}}^{\text{wall}}} = \phi_{\text{LJ}}$ ということになり, 先行研究と同じシミュレーションを行うことができる.

% \begin{figure}[H]
%   \centering
%   \href{https://youtu.be/CIEyUPvPY6A}{\includegraphics[scale=0.2]{image/2023-11-21T21:01:17.543_followup_chi1.265_Ay100_rho0.4_T0.43_dT0.04_Rd0.0_Rt0.5_Ra1.877538_g0.00019998593898298055_run1.0e8_output.png}}
%   \caption{$t \sqrt{\varepsilon / m \sigma^2} = 1.0 \times 10^{6}$でのスナップショット}
%   \label{}
% \end{figure}

\section{重力と熱流を同時にかける}

以下のように, $\text{R}_\text{a}$と$\text{R}_\text{t}$を少しずつ変えた系を設定して, 25種類の系でそれぞれシミュレーションをした.

\vspace{1\baselineskip}

\begin{tabular}{|c|c|c|c|c|c|} \hline
        & $\text{R}_\text{a}:0.0$ & $\text{R}_\text{a}:0.4693$ & $\text{R}_\text{a}:0.9387$ & $\text{R}_\text{a}:1.408$ & $\text{R}_\text{a}:1.877$ \\ \hline
  $\text{R}_\text{t}:0.0$ & a      & b      & c      & d      & e     \\ \hline
  $\text{R}_\text{t}:0.125$ & f      & g      & h      & i      & j     \\ \hline
  $\text{R}_\text{t}:0.25$ & k      & l      & m      & n      & o     \\ \hline
  $\text{R}_\text{t}:0.375$ & p      & q      & r      & s      & t     \\ \hline
  $\text{R}_\text{t}:0.5$ & u      & v      & w      & x      & y     \\ \hline
\end{tabular}

\vspace{1\baselineskip}



パラメータを確認する.

\begin{itemize}
  \item $N = 1250$
  \item $\rho {\sigma}^2 = 0.4$
  \item $L_x / \sigma = 39.5\dots$
  \item $L_y / \sigma = 79.0\dots$
  \item $k_{\text{B}} T / \varepsilon = 0.43$
  \item $k_{\text{B}} \Delta T / \varepsilon = 0.04$
  \item $mg\sigma/\varepsilon = 4.0 \times 10^{-4}$
  \item $t_f \sqrt{\varepsilon / m \sigma^2} = 2.0 \times 10^{5}$
\end{itemize}

この際の粒子集団の様相は以下のようになる.

リンク先の動画は $t \sqrt{\varepsilon / m \sigma^2} = 200$ ごとに表示している. 

\input{subtex/RaRtmap_movie.tex}

重心位置$Y_g$を系の$y$幅でスケーリングして, 時系列プロットすると,

\begin{align}
  Y_g &\equiv \bar{y_i} = \frac{1}{N} \sum_{i}^{N} y_i
\end{align}

\input{subtex/RaRtmap_time.tex}


\section{重力を先にかけて, 熱流を後からかける}

以下は, 追実験のときと同じように, まず重力のみをかけて, 粒子集団が落ちきってから熱流をかけると同時に測定を開始するものである.

\input{subtex/RaRtmap_drop_time.tex}



\section{重力のみをかける}

\begin{itemize}
  \item $N = 1250$
  \item $\rho {\sigma}^2 = 0.4$
  \item $L_x / \sigma = 39.5\dots$
  \item $L_y / \sigma = 79.0\dots$
  \item $k_{\text{B}} T / \varepsilon = 0.43$
  \item $k_{\text{B}} \Delta T / \varepsilon = 0.0$
  \item $mg\sigma/\varepsilon = 4.0 \times 10^{-4}$
  \item $t_f \sqrt{\varepsilon / m \sigma^2} = 2.0 \times 10^{5}$
\end{itemize}

\input{subtex/dT0_time.tex}

\section{熱流のみをかける}

\begin{itemize}
  \item $N = 1250$
  \item $\rho {\sigma}^2 = 0.4$
  \item $L_x / \sigma = 39.5\dots$
  \item $L_y / \sigma = 79.0\dots$
  \item $k_{\text{B}} T / \varepsilon = 0.43$
  \item $k_{\text{B}} \Delta T / \varepsilon = 0.04$
  \item $mg\sigma/\varepsilon = 0.0$
  \item $t_f \sqrt{\varepsilon / m \sigma^2} = 2.0 \times 10^{5}$
\end{itemize}

\input{subtex/g0_time.tex}

\section{重力と熱流を同時にかける(時間10倍)}

\begin{itemize}
  \item $N = 1250$
  \item $\rho {\sigma}^2 = 0.4$
  \item $L_x / \sigma = 39.5\dots$
  \item $L_y / \sigma = 79.0\dots$
  \item $k_{\text{B}} T / \varepsilon = 0.43$
  \item $k_{\text{B}} \Delta T / \varepsilon = 0.04$
  \item $mg\sigma/\varepsilon = 4.0 \times 10^{-4}$
  \item $t_f \sqrt{\varepsilon / m \sigma^2} = 2.0 \times 10^{6}$
\end{itemize}

\input{subtex/RaRtmap10_time.tex}

\section{重力を先にかけて, 熱流を後からかける(時間10倍)}

\input{subtex/qrs10_drop_time.tex}